@layout MainLayout
@page "/patient-management"
@using Dexterity.Components.Pages.PatientManager.Dialogs
<style>
    .mud-tabs-toolbar-content {
        overflow-x: scroll !important;
    }

        .mud-tabs-toolbar-content::-webkit-scrollbar {
            display: none !important;
        }
</style>

<TopTitleBar Title="Patient Management" Image="modules/patients.svg"/>
<MudItem md="12" Class="vertical-space">
    <InnerLayout>
        <NavigationItems>
            <MudNavLink Match="NavLinkMatch.All" Icon="fas fa-user-magnifying-glass" IconColor="MudColor.Info"
                        @onclick="@(() => ClickChanged(0))">
                Search Patient
            </MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="fas fa-person-circle-plus" IconColor="MudColor.Info"
                        @onclick="@(AddNewPatient)">
                Quick Patient
            </MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="fas fa-user-plus" IconColor="MudColor.Info"
                        @onclick="@(() => ClickChanged(1))">
                Add Patient
            </MudNavLink>

            <MudNavLink Match="NavLinkMatch.All" Icon="fas fa-user-pen" IconColor="MudColor.Info"
                        @onclick="@(() => ClickChanged(2))">
                Open Patient
            </MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="fas fa-family" IconColor="MudColor.Info"
                        @onclick="@(() => ClickChanged(3))">
                Patient Families
            </MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="fas fa-rectangle-list" IconColor="MudColor.Info"
                        @onclick="@(() => ClickChanged(4))">
                Open Patient Summary
            </MudNavLink>
            <MudNavLink Match="NavLinkMatch.All" Icon="fas fa-solid fa-file-user" IconColor="MudColor.Info"
                        @onclick="@(() => ClickChanged(5))">
                Patients Accounts
            </MudNavLink>
        </NavigationItems>

        <DexContentTabs>
            <div class="d-flex justify-center align-center mt-lg-5" style="width: 100%!important;">
                <MudTabs @ref="_tabs">
                    <MudTabPanel Text="">
                        <PatientList/>
                    </MudTabPanel>
                    <MudTabPanel Text="">
                        <AddNewPatient/>
                    </MudTabPanel>
                </MudTabs>
            </div>

        </DexContentTabs>
    </InnerLayout>
</MudItem>

@code {
    private bool _open = true;
    MudTabs _tabs;

    private void ClickChanged(int tabIndex)
    {
        _tabs.ActivatePanel(tabIndex);
    }

    private async Task AddNewPatient()
    {
        var parameters = new DialogParameters();
        var options = new DialogOptions() {CloseButton = true, MaxWidth = MaxWidth.Small, FullWidth = true, Position = DialogPosition.Center};
        await DialogService.ShowAsync<QuickAddPatientModal>("New Patient", parameters, options);
    }

}